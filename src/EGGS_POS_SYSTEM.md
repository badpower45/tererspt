# نظام POS لبيع البيض - AddValues ERP

## نظرة عامة

نظام نقطة بيع (Point of Sale) متخصص وسريع لبيع البيض بأنواعه المختلفة. تم تصميمه ليكون سهل الاستخدام مع واجهة مبسطة تركز على السرعة والكفاءة.

---

## الميزات الرئيسية

### ✅ 1. إدارة منتجات البيض
- أنواع متعددة: أبيض، بني، عضوي، حر الحركة
- أحجام متنوعة: صغير، وسط، كبير، كبير جداً، جامبو
- البيع بالطبق (30 بيضة) أو بالقطعة الفردية
- أسعار منفصلة للطبق والقطعة

### ✅ 2. واجهة POS سريعة
- تصميم مرئي بالبطاقات (Cards)
- إضافة سريعة للسلة (طبق أو قطعة)
- سلة تفاعلية مع تحديث فوري
- حساب تلقائي للإجمالي

### ✅ 3. إدارة السلة
- زيادة/تقليل الكمية بسهولة
- حذف منتجات من السلة
- عرض تفصيلي لكل منتج
- حساب إجمالي فرعي وخصومات

### ✅ 4. خيارات الدفع
- نقدي (Cash)
- بطاقة (Card)
- تحويل بنكي (Transfer)

### ✅ 5. إدارة العملاء
- حفظ اسم العميل (اختياري)
- سجل عمليات الشراء
- تطبيق خصومات

---

## أنواع البيض المتاحة

### 1. بيض أبيض كبير (White Large)
- **الحجم**: كبير (Large)
- **الكمية بالطبق**: 30 بيضة
- **سعر الطبق**: 95 جنيه
- **سعر القطعة**: 3.5 جنيه
- **المورد**: مزرعة الأمل

### 2. بيض بني وسط (Brown Medium)
- **الحجم**: وسط (Medium)
- **الكمية بالطبق**: 30 بيضة
- **سعر الطبق**: 90 جنيه
- **سعر القطعة**: 3.2 جنيه
- **المورد**: مزرعة السعادة

### 3. بيض عضوي كبير جداً (Organic Extra Large)
- **الحجم**: كبير جداً (Extra Large)
- **الكمية بالطبق**: 30 بيضة
- **سعر الطبق**: 140 جنيه
- **سعر القطعة**: 5 جنيه
- **المورد**: مزرعة الخير العضوية

### 4. بيض حر الحركة جامبو (Free Range Jumbo)
- **الحجم**: جامبو (Jumbo)
- **الكمية بالطبق**: 30 بيضة
- **سعر الطبق**: 130 جنيه
- **سعر القطعة**: 4.5 جنيه
- **المورد**: مزرعة الطبيعة

---

## سير العمل (Workflow)

### عملية البيع الكاملة

```
1. تسجيل دخول الكاشير
   ↓
2. فتح شاشة POS تلقائياً
   ↓
3. اختيار المنتجات
   - نقر على زر "+ طبق" أو "+ قطعة"
   - إضافة المنتج للسلة
   ↓
4. تعديل الكميات (إذا لزم)
   - زيادة/تقليل الأطباق
   - زيادة/تقليل القطع الفردية
   ↓
5. إدخال اسم العميل (اختياري)
   ↓
6. إضافة خصم (إذا لزم)
   ↓
7. اختيار طريقة الدفع
   - نقدي / بطاقة / تحويل
   ↓
8. إتمام البيع وطباعة الفاتورة
   ↓
9. إعادة تعيين السلة تلقائياً
```

---

## واجهة المستخدم

### الشاشة الرئيسية

#### الجانب الأيسر (2/3 من الشاشة)
**المنتجات المتاحة**
- عرض جميع منتجات البيض في شبكة (Grid)
- كل منتج في بطاقة (Card) تحتوي على:
  - اسم المنتج
  - النوع (أبيض/بني/عضوي/حر الحركة)
  - الحجم
  - سعر الطبق
  - سعر القطعة
  - زرين: "+ طبق" و "+ قطعة"

#### الجانب الأيمن (1/3 من الشاشة)
**السلة (Cart)**
- اسم العميل (حقل نصي اختياري)
- قائمة المنتجات في السلة:
  - اسم المنتج
  - عدد الأطباق (مع أزرار +/-)
  - عدد القطع (مع أزرار +/-)
  - الإجمالي لكل منتج
  - زر حذف
- خصم (حقل رقمي)
- المجموع الفرعي
- الإجمالي النهائي
- طرق الدفع (3 أزرار)
- زر "إتمام البيع وطباعة الفاتورة"

---

## هيكل البيانات

### EggProduct (منتج البيض)
```typescript
{
  id: string;
  name: string;
  type: 'white' | 'brown' | 'organic' | 'free_range';
  size: 'small' | 'medium' | 'large' | 'extra_large' | 'jumbo';
  quantity_per_tray: number;  // عادة 30
  cost_per_tray: number;
  sell_price_per_tray: number;
  sell_price_per_piece: number;
  barcode?: string;
  supplier?: string;
  created_at: string;
  updated_at: string;
}
```

### EggSale (عملية بيع)
```typescript
{
  id: string;
  branch_id: string;
  cashier_id: string;
  customer_name?: string;
  items: EggSaleItem[];
  total_amount: number;
  payment_method: 'cash' | 'card' | 'transfer';
  discount?: number;
  created_at: string;
}
```

### EggSaleItem (عنصر في البيع)
```typescript
{
  egg_product_id: string;
  product_name: string;
  trays: number;         // عدد الأطباق
  pieces: number;        // قطع فردية
  unit_price_tray: number;
  unit_price_piece: number;
  total: number;
}
```

---

## الحسابات

### صيغة حساب الإجمالي لمنتج
```
total = (trays × unit_price_tray) + (pieces × unit_price_piece)
```

### مثال:
- منتج: بيض أبيض كبير
- الكمية: 2 طبق + 5 قطع
- سعر الطبق: 95 جنيه
- سعر القطعة: 3.5 جنيه

```
total = (2 × 95) + (5 × 3.5)
total = 190 + 17.5
total = 207.5 جنيه
```

### الخصومات
```
final_total = subtotal - discount
```

---

## إدارة المخزون

### EggInventory
```typescript
{
  id: string;
  egg_product_id: string;
  branch_id: string;
  trays_in_stock: number;      // أطباق في المخزون
  pieces_in_stock: number;     // قطع فردية
  min_stock_trays: number;     // حد أدنى للتنبيه
  last_restocked: string;
}
```

### خصم من المخزون عند البيع
```typescript
// عند إتمام البيع
for (const item of sale.items) {
  const inventory = getInventory(item.egg_product_id, branchId);
  
  // خصم الأطباق
  inventory.trays_in_stock -= item.trays;
  
  // خصم القطع الفردية
  inventory.pieces_in_stock -= item.pieces;
  
  // إذا كانت القطع الفردية أقل من صفر، خصم من الأطباق
  if (inventory.pieces_in_stock < 0) {
    const traysNeeded = Math.ceil(Math.abs(inventory.pieces_in_stock) / 30);
    inventory.trays_in_stock -= traysNeeded;
    inventory.pieces_in_stock += (traysNeeded × 30);
  }
  
  // تحديث المخزون
  updateInventory(inventory);
  
  // تنبيه إذا وصل لحد أدنى
  if (inventory.trays_in_stock <= inventory.min_stock_trays) {
    sendLowStockAlert(inventory);
  }
}
```

---

## التقارير والإحصائيات

### تقرير يومي
- إجمالي المبيعات
- عدد العمليات
- متوسط قيمة العملية
- أكثر المنتجات مبيعاً
- طرق الدفع المستخدمة
- إجمالي الخصومات

### تقرير شهري
- مقارنة المبيعات بالأشهر السابقة
- تحليل الأداء حسب المنتج
- تحليل الأداء حسب الكاشير
- معدل دوران المخزون

---

## الصلاحيات

### من يمكنه استخدام POS للبيض؟

| الدور | الوصول |
|------|--------|
| Super Admin | ✅ كامل |
| Branch Manager | ✅ كامل |
| Sales Manager | ✅ كامل |
| Cashier | ✅ فقط POS |
| Inventory Manager | ❌ |
| Partner Manager | ❌ |
| Installer | ❌ |

---

## الاختصارات والمفاتيح (Shortcuts)

للإنتاجية العالية، يمكن إضافة اختصارات لوحة مفاتيح:

- `F1` - بيض أبيض + طبق
- `F2` - بيض بني + طبق
- `F3` - بيض عضوي + طبق
- `F4` - بيض حر الحركة + طبق
- `Enter` - إتمام البيع
- `Esc` - إلغاء/إعادة تعيين السلة
- `Tab` - التنقل بين الحقول

---

## طباعة الفاتورة

### تصميم الفاتورة
```
==========================================
        AddValues - نقطة البيع
==========================================
التاريخ: 16/12/2024    الوقت: 10:30 AM
الكاشير: فاطمة حسن
العميل: أحمد محمد
==========================================

بيض أبيض كبير
  2 طبق × 95 ج.م         190.00 ج.م
  5 قطعة × 3.5 ج.م        17.50 ج.م
                        -------
                        207.50 ج.م

بيض عضوي كبير جداً
  1 طبق × 140 ج.م        140.00 ج.م
                        -------
                        140.00 ج.م

==========================================
المجموع الفرعي:         347.50 ج.م
الخصم:                  -10.00 ج.م
------------------------------------------
الإجمالي:               337.50 ج.م
==========================================
طريقة الدفع: نقدي
==========================================
       شكراً لزيارتكم
    نتمنى رؤيتكم قريباً
==========================================
```

---

## الأمان

### الحماية من الأخطاء
1. **التحقق من المخزون**: عدم السماح بالبيع إذا كان المخزون غير كافٍ
2. **التحقق من الأسعار**: منع الأسعار السالبة أو صفر
3. **التحقق من الكميات**: منع الكميات السالبة
4. **تأكيد العمليات**: تأكيد قبل حذف منتج أو إلغاء البيع

### سجل العمليات (Audit Log)
```typescript
{
  id: string;
  action: 'sale_completed' | 'sale_cancelled' | 'item_removed';
  user_id: string;
  details: object;
  timestamp: string;
}
```

---

## التكامل مع النظام الرئيسي

### مزامنة البيانات
- المبيعات من POS تُسجل تلقائياً في نظام المبيعات الرئيسي
- المخزون يتم تحديثه فورياً
- التقارير تظهر في لوحة التحكم الرئيسية

### التوافق
- نفس قاعدة البيانات
- نفس نظام الصلاحيات
- نفس إدارة الفروع

---

## التطوير المستقبلي

### المرحلة القادمة
- [ ] دعم الماسح الضوئي (Barcode Scanner)
- [ ] طباعة الفاتورة على طابعة حرارية
- [ ] وضع offline مع مزامنة لاحقة
- [ ] تطبيق موبايل للكاشير
- [ ] دعم الخصومات التلقائية
- [ ] برنامج ولاء العملاء
- [ ] تكامل مع أنظمة الدفع الإلكتروني

---

## استكشاف الأخطاء

### مشكلة: لا تظهر المنتجات
**الحل**: تأكد من وجود بيانات mock في المخزون

### مشكلة: لا يتم حفظ المبيعات
**الحل**: تحقق من صلاحيات الكاشير والاتصال بقاعدة البيانات

### مشكلة: الحسابات خاطئة
**الحل**: تحقق من صيغة الحساب وأسعار المنتجات

---

## الدعم الفني

للدعم والاستفسارات:
- Email: support@addvalues.com
- Phone: +20123456789
- WhatsApp: +20123456789

**آخر تحديث:** ديسمبر 2024
**الإصدار:** 1.0.0
